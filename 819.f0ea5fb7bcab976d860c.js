(self.webpackChunk=self.webpackChunk||[]).push([[819],{5819:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return X}});var i=n(2608),r=n(5947),o={offsetLeft:0,offsetTop:0,columnCount:0,rowCount:0,letterWidth:0,letterHeight:0,fontSize:0,curPos:"C:\\",curPosObj:null,options:localStorage.terminalOptions?JSON.parse(localStorage.terminalOptions):{color:"#1eff00",showPos:!0,ps:0,isGlitched:!0}};function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,r,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw r}}return o}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=f(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function f(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Date;this.name=e,this.date=r,this.size=i.length,this.content=i,this.parent=t,this.toJSON=function(){return{name:n.name,date:n.date,content:n.content}}}function d(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date;this.name=e,this.date=i,this.children=[],this.parent=t,this.toJSON=function(){return{name:n.name,date:n.date,children:n.children}}}function m(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=x(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function x(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=r.b.filter((function(e){return"Terminal"!==e.name})),O=new function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"C";h(this,e),u(this,"init",(function(){if(localStorage.getItem("disk")){var e=JSON.parse(localStorage.getItem("disk"));!function e(t,n){t.children=[];var i,r=c(n.children);try{for(r.s();!(i=r.n()).done;){var o=i.value;if(void 0!==o.content)t.children.push(new g(o.name,t,n.content,n.date));else{var a=new d(o.name,t,n.date);e(a,o),t.children.push(a)}}}catch(e){r.e(e)}finally{r.f()}}(t,e),t.name=e.name}else{var n=new d("Documents",t),i=new d("Music",t),r=new d("Logs",n);n.children.push(r),r.children.push(new g("log1.log",r,"[SUCCESS] log1")),r.children.push(new g("log2.log",r,"[SUCCESS] log2")),r.children.push(new g("log3.log",r,"[SUCCESS] log3")),r.children.push(new g("log4.log",r,"[ ERROR ] Decode BASE64")),r.children.push(new g("log5.log",r,"[SUCCESS] log5")),i.children.push(new g("music.txt",i,"YWJiYSAtIGdpbW1lIGdpbW1lIGdpbW1l")),t.children.push(n),t.children.push(i),t.children.push(new d("Pictures",t)),t.children.push(new d("Desktop",t)),localStorage.setItem("disk",JSON.stringify(t))}})),u(this,"getChild",(function(e,t){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=e;i||(n=t.pop());var f,s=c(t);try{var h=function(){var e=f.value;if(".."===e){if(a.parent)return a=a.parent,"continue"}else{var t=a.children.find((function(t){return t.name.toLowerCase()===e&&t instanceof d}));if(t)return a=t,"continue";if(r){var n=new d(e,a);return a.children.push(n),a=n,"continue"}}return{v:null}};for(s.s();!(f=s.n()).done;){var u=h();if("continue"!==u&&"object"===l(u))return u.v}}catch(e){s.e(e)}finally{s.f()}if(n){var m=a.children.find((function(e){return e.name.toLowerCase()===n}));if(o){if(m&&m instanceof g)return null;var p=new g(n,a);a.children.push(p),a=p}else a=!1!==i||m instanceof g?m:null}return a})),u(this,"getFromPath",(function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t.parsePath(e),r=a(i,2),o=r[0],l=r[1];return o?t.getChild(o,l,n):null})),u(this,"parsePath",(function(e){e=e.trim().toLowerCase(),/[\\/]/.test(e[0])&&(e=e.substr(1)),/[\\/]/.test(e[e.length-1])&&(e=e.substr(0,e.length-1));var n=e.split(/[\\/]/),i=null;if(n[0].includes(":")){if(t.name.toLowerCase()!==n[0])return[null,null];i=t,n.shift()}else""===n[0]?(i=o.curPosObj,n.shift()):i=o.curPosObj;return[i,n]})),u(this,"createPath",(function(e){if(""===e)return null;var n=a(t.parsePath(e),2),i=n[0],r=n[1];if(!i)return null;var o=t.getChild(i,r,!0,!0);return localStorage.setItem("disk",JSON.stringify(t)),o})),u(this,"createFile",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(""===e)return null;var i=t.parsePath(e),r=a(i,2),o=r[0],l=r[1];if(!o)return null;var c=t.getChild(o,l,!1,!1,!0);return c&&(c.content=n),localStorage.setItem("disk",JSON.stringify(t)),c})),u(this,"removeChild",(function(e){e.parent.children=e.parent.children.filter((function(t){return t!==e})),localStorage.setItem("disk",JSON.stringify(t))})),u(this,"renameChild",(function(e,n){e.name=n,localStorage.setItem("disk",JSON.stringify(t))})),u(this,"writeFile",(function(e,n){e.content=n,localStorage.setItem("disk",JSON.stringify(t))})),u(this,"getFullPath",(function(e){for(var t=[];e;)t.unshift(e.name),e=e.parent;return t.join("\\")})),u(this,"addFolder",(function(e,t){var n=new d(t,e);return e.children.push(n),n})),this.name=n+":",this.children=[],this.init()},T=function e(t,n,i,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),v(this,"ParseAttr",(function(e){for(var t=[],n=null,i=!1,r=0;r<e.length;r++){if('"'===e[r])if(null===n)n=r,i=!0;else""!==e.slice(n+1,r).trim()&&t.push(e.slice(n+1,r)),n=null,i=!1;else" "!==e[r]||i||null===n?" "!==e[r]&&null===n&&(n=r):(t.push(e.slice(n,r)),n=null)}return null!==n&&t.push(e.slice(n,e.length)),t})),v(this,"cd",(function(e){if(e.includes("--help"))return["Изменяет текущий каталог"," ","CD [путь]","CD [..]","  ..  обозначает переход в родительский каталог.","Имя текущего каталога в строке вызова преобразуется к тому же регистру символов, что и для существующих имен на диске.","Так, команда CD C:\\TEMP сделает текущим каталог C:\\Temp, если он существует на диске."," "];var t=O.getFromPath(e);return t?(o.curPos=O.getFullPath(t),o.curPosObj=t,void a.OnOptionChanged()):["Системе не удается найти указанный путь."]})),v(this,"chps",(function(e){if(e.includes("--help"))return["Устанавливает стиль приветствия"," ","CHPS [attr] [-D]"," ","attr Установка атрибута стиля приветствия.","-D   Отображение текущей директории"," ","Стиль задаётся в виде десятичного числа. Число может иметь следующие значения:"," "," 0 = ┌──(user㉿windows)-[/]","     └─$ "," 1 = user@user㉿windows:/$ "," 2 = /> "," ","Если аргумент не указан, команда ничего не меняет."];if((e=a.ParseAttr(e)).length>2)return["Неверный формат команды."];if(0!==e.length){o.options.showPos=!1;var t,n=p(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;"-D"===i?o.options.showPos=!0:!isNaN(i)&&i<3&&i>=0&&(o.options.ps=Number(i))}}catch(e){n.e(e)}finally{n.f()}a.OnOptionChanged()}})),v(this,"chtheme",(function(e){if(e.includes("--help"))return["Изменяет тему сайта"," ","CHTHEME [название]"," ","Название задаётся в виде десятичного числа. Число может иметь следующие значения:"," "].concat(m(y.map((function(e,t){return"".concat(t," = ").concat(e.name)}))),[" ","Если аргумент не указан, команда ничего не меняет."," "]);""!==e&&!isNaN(e)&&e<y.length&&e>=0&&a.OnThemeChanged(y[e])})),v(this,"cls",(function(e){if(e.includes("--help"))return["Очищает содержимое экрана"," ","CLS"," "];a.Clear()})),v(this,"color",(function(e){if(e.includes("--help"))return["Устанавливает цвет консоли"," ","COLOR [attr]"," ","attr Установка атрибута цветов для вывода консоли."," ","Цвет задаётся в виде шестнадцатеричной цифры. Каждая цифра может иметь следующие значения:"," "," 0 = Тёмный   8 = Серый"," 1 = Синий    9 = Светло-синий"," 2 = Зеленый  A = Светло-зеленый"," 3 = Голубой  B = Светло-голубой"," 4 = Красный  C = Светло-красный"," 5 = Лиловый  D = Светло-лиловый"," 6 = Желтый   E = Светло-желтый"," 7 = Белый    F = Ярко-белый"," ","Если аргумент не указан, команда устанавливает цвет по умолчанию (Серый)."];if(""===e)return o.options.color="#cccccc",void a.OnOptionChanged();var t=function(e){switch(e){case"0":return"#222222";case"8":return"#767676";case"1":return"#0040ff";case"9":return"#7fa8ff";case"2":return"#1eff00";case"a":return"#86ff7f";case"3":return"#42adff";case"b":return"#7fffff";case"4":return"#ff1428";case"c":return"#ff7f8a";case"5":return"#e626ff";case"d":return"#ff7ff0";case"6":return"#ffcc00";case"e":return"#fff27f";case"7":return"#CCCCCC";case"f":return"#ffffff";default:return null}}(e);return t?(o.options.color=t,void a.OnOptionChanged()):["Данная команда не поддерживается."]})),v(this,"cowsay",(function(e){if(e.includes("--help"))return["Выводит сообщение"," ","Выводит изображение говорящей коровы, нарисованной в ASCII-символах, с <облачком> фразы в котором написан какой-нибудь заданный текст"];var t=a.minWidth-4,n=[];if(e.length>t){var i,r=[],o=0,l=[],c=p(e.split(" "));try{for(c.s();!(i=c.n()).done;){var f=i.value;if(f.length>=t){l.push(f.substr(0,t-o)),r.push(l.join(" ")),l=[];for(var s=0;s<Math.ceil((f.length-o)/t);s++){var h=f.substr(t-o+s*t,t);h.length===t?r.push(h):l.push(h)}o=l.length>0?l[0].length+1:0}else o+f.length>=t&&(r.push(l.join(" ").padEnd(t)),o=0,l=[]),l.push(f),o+=f.length+1}}catch(e){c.e(e)}finally{c.f()}l&&r.push(l.join(" ").padEnd(t));for(var u=0;u<r.length;u++)0===u?n.push("/ ".concat(r[u]," \\")):u===r.length-1?n.push("\\ ".concat(r[u]," /")):n.push("| ".concat(r[u]," |"))}else n.push("< ".concat(e.padStart(t-(t-e.length)/2).padEnd(t)," >"));return["".padStart(a.minWidth,"_")].concat(n,["".padStart(a.minWidth,"-"),"    \\","     \\","       ^__^","       (oo)\\_______","       (__)\\       )\\/\\","           ||----w |","           ||     ||"])})),v(this,"dir",(function(e){if(e.includes("--help"))return["Вывод файлов и подкаталогов"," ","Вывод списка файлов и подкаталогов в указанном каталоге.","DIR [путь]"," "];var t,n=O.getFromPath(e);if(n){var i,r=[" Содержимое папки ".concat(O.getFullPath(n))],o=p(n.children);try{for(o.s();!(i=o.n()).done;){var a,l=i.value;r.push((null===(a=l.date)||void 0===a?void 0:a.toLocaleString())+"    "+(void 0===l.content?"<DIR>":"     ")+"    "+(((t=l.size)?(t=String(t)).length>11?">9999999999":t.padStart(11):"           ")+" ")+l.name)}}catch(e){o.e(e)}finally{o.f()}return r}return["Системе не удается найти указанный путь."]})),v(this,"glitch",(function(e){if(e.includes("--help"))return["Включает/выключает сбои"," ","GLITCH [on/off]"," "];switch(e){case"on":o.options.isGlitched=!0,a.OnOptionChanged();break;case"off":o.options.isGlitched=!1,a.OnOptionChanged();break;case"":o.options.isGlitched=!0,a.OnOptionChanged();break;default:return["Данная команда не поддерживается."]}})),v(this,"help",(function(e){if(e.includes("--help"))return["Вывод сведений о командах"," ","HELP [<команда>]"," ","    <команда> - команда, интересующая пользователя"," "];if(0===e.length){var t=["Для получения сведений об определенной команде наберите HELP <имя команды>."];for(var n in a)"function"==typeof a[n]&&n[0].toLowerCase()===n[0]&&t.push(n.padEnd(12)+a[n]("--help")[0]);return t}return"function"==typeof a[e]&&e[0].toLowerCase()===e[0]?a[e]("--help"):["Данная команда не поддерживается."]})),v(this,"mkdir",(function(e){if(e.includes("--help"))return["Создание каталога"," ","MKDIR [диск:]путь"," "];var t=O.createPath(e);return t?["Дирректория ".concat(t.name," создана.")]:["Неверно указан путь."]})),v(this,"mkfile",(function(e){if(e.includes("--help"))return["Создание файла"," ","MKFILE [диск:]путь [текст]"," "];if((e=a.ParseAttr(e)).length>2)return["Неверный формат команды."];var t=O.createFile.apply(O,m(e));return t?["Файл ".concat(t.name," создан.")]:["Системе не удается найти указанный путь."]})),v(this,"play",(function(e){if(e.includes("--help"))return["Запускает игру"," ","PLAY [game]"," ","Игра задаётся в виде десятичного числа. Число может иметь следующие значения:"," "," 0 = Тетрис"," 1 = Арканоид"," 2 = Крестики-нолики"];switch(e){case"0":return void a.StartGame("tetris");case"1":return void a.StartGame("arkanoid");case"2":return void a.StartGame("ticTacToe");default:return["Данная команда не поддерживается."]}})),v(this,"rename",(function(e){if(e.includes("--help"))return["Переименование файла/дирректории"," ","RENAME [диск:]путь название"," "];if(2!==(e=a.ParseAttr(e)).length)return["Неверный формат команды."];var t=O.getFromPath(e[0],null);if(t){var n=t.name;return O.renameChild(t,e[1]),o.curPos=O.getFullPath(o.curPosObj),a.OnOptionChanged(),[void 0===t.content?"Дирректория ".concat(n," переименована в ").concat(t.name,"."):"Файл ".concat(n," переименован в ").concat(t.name,".")]}return["Системе не удается найти указанный путь."]})),v(this,"rmdir",(function(e){if(e.includes("--help"))return["Удаление каталога"," ","RMDIR [диск:]путь [-S]"," ","   -S   Удаление дерева каталогов, т. е. не только указанного каталога, но и всех содержащихся в нем файлов и подкаталогов.",""];e=a.ParseAttr(e);var t=!1,n=o.curPosObj;if(e.length>2)return["Неверный формат команды."];var i,r=p(e);try{for(r.s();!(i=r.n()).done;){var l=i.value;"-s"===l?t=!0:n=O.getFromPath(l)}}catch(e){r.e(e)}finally{r.f()}return n?n===o.curPosObj?["Невозможно удалить дирректорию."]:t||0===n.children.length?(O.removeChild(n),["Дирректория ".concat(n.name," удалена.")]):["Указанная дирректория не пуста."]:["Системе не удается найти указанный путь."]})),v(this,"rmfile",(function(e){if(e.includes("--help"))return["Удаление файла"," ","RMFILE [диск:]путь"," "];var t=O.getFromPath(e,!1);return t?(O.removeChild(t),["Файл ".concat(t.name," удален.")]):["Системе не удается найти указанный путь."]})),v(this,"tree",(function(e){if(e.includes("--help"))return["Структура папок"," ","TREE [путь] [-F]"," ","   -F   Вывод имен файлов в каждой папке."," "];e=a.ParseAttr(e);var t=!1,n=o.curPosObj;if(e.length>2)return["Неверный формат команды."];var i,r=p(e);try{for(r.s();!(i=r.n()).done;){var l=i.value;"-f"===l?t=!0:n=O.getFromPath(l)}}catch(e){r.e(e)}finally{r.f()}return n?[O.getFullPath(n)].concat(m(function e(n,i){for(var r=[],o=t?n.children:n.children.filter((function(e){return void 0===e.content})),a=0;a<o.length;a++)a===o.length-1?r.push(i+"└───"+o[a].name):r.push(i+"├───"+o[a].name),void 0===o[a].content&&r.push.apply(r,m(e(o[a],a===o.length-1?i+"    ":i+"│   ")));return r}(n,""))):["Системе не удается найти указанный путь."]})),v(this,"type",(function(e){if(e.includes("--help"))return["Вывод содержимого файла"," ","TYPE [путь]имя_файла"," "];var t=O.getFromPath(e,!1);return t&&void 0!==t.content?[t.content]:["Системе не удается найти указанный файл."]})),v(this,"write",(function(e){if(e.includes("--help"))return["Запись текста в файл"," ","WRITE [диск:]путь текст"," "];if(2!==(e=a.ParseAttr(e)).length)return["Неверный формат команды."];var t=O.getFromPath(e[0],!1);return t?(O.writeFile(t,e[1]),["Файл ".concat(t.name," перезаписан.")]):["Системе не удается найти указанный путь."]})),this.minWidth=32,this.Clear=t,this.OnOptionChanged=n,this.OnThemeChanged=i,this.StartGame=r,o.curPosObj=O,o.curPos=O.name},S=n(172);function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=function e(t,n,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),b(this,"Start",(function(){document.addEventListener("keydown",a.OnKeyDown),a.canvas.addEventListener("click",a.OnClick),a.Resize(),a.game.Reset()})),b(this,"Leave",(function(){a.game.Stop(),document.removeEventListener("keydown",a.OnKeyDown),a.canvas.removeEventListener("click",a.OnClick)})),b(this,"OnKeyDown",(function(e){"KeyR"===e.code&&a.game.stop&&a.game.Reset()})),b(this,"OnClick",(function(){a.game.stop&&a.game.Reset()})),b(this,"Resize",(function(){o.offsetLeft+o.rowCount*o.letterHeight/2+2*o.letterHeight+10*o.letterWidth+o.offsetLeft>window.innerWidth?(a.game.tile=(o.rowCount-4)*o.letterHeight/20,a.gameOffsetTop=o.offsetTop+4*o.letterHeight,a.gameOffsetLeft=window.innerWidth/2-5*a.game.tile):(a.game.tile=o.rowCount*o.letterHeight/20,a.gameOffsetTop=o.offsetTop,a.gameOffsetLeft=window.innerWidth/2-5*a.game.tile-5*o.letterWidth),r.h&&(a.ctx.font="".concat(o.fontSize,"px monospace"),a.ctx.fillStyle=o.options.color,a.ctx.fillText("X",window.innerWidth-o.letterWidth-16,o.fontSize+9)),a.OnFigureChanged(),a.OnScoreChanged()})),b(this,"OnFigureChanged",(function(){var e,t;switch(a.ctx.font="".concat(o.fontSize,"px monospace"),a.ctx.fillStyle=o.options.color,a.ctx.shadowColor=o.options.color,a.ctx.shadowBlur=o.letterHeight,a.gameOffsetTop===o.offsetTop?(e=a.gameOffsetLeft+10*a.game.tile+2*o.letterHeight,t=o.offsetTop+o.letterHeight+o.fontSize,a.ctx.clearRect(e-o.letterHeight,o.offsetTop-o.letterHeight,10*o.letterWidth+2*o.letterHeight,5*o.letterHeight),a.ctx.fillText("Следующие:",e,o.offsetTop+o.fontSize)):(e=a.gameOffsetLeft,t=o.offsetTop+o.fontSize,a.ctx.clearRect(a.gameOffsetLeft-o.letterHeight,o.offsetTop-o.letterHeight,8*o.letterWidth+2*o.letterHeight,4*o.letterHeight)),a.game.nextFigure){case 0:a.ctx.fillText("[][][][]",e,t+o.letterHeight/2);break;case 1:a.ctx.fillText("  [][]",e,t),a.ctx.fillText("  [][]",e,t+o.letterHeight);break;case 2:a.ctx.fillText("   [][]",e,t),a.ctx.fillText(" [][]",e,t+o.letterHeight);break;case 3:a.ctx.fillText(" [][]",e,t),a.ctx.fillText("   [][]",e,t+o.letterHeight);break;case 4:a.ctx.fillText(" []",e,t),a.ctx.fillText(" [][][]",e,t+o.letterHeight);break;case 5:a.ctx.fillText(" [][][]",e,t),a.ctx.fillText(" []",e,t+o.letterHeight);break;case 6:a.ctx.fillText("   []",e,t),a.ctx.fillText(" [][][]",e,t+o.letterHeight)}})),b(this,"OnScoreChanged",(function(){a.ctx.font="".concat(o.fontSize,"px monospace"),a.ctx.fillStyle=o.options.color,a.ctx.shadowColor=o.options.color,a.ctx.shadowBlur=o.letterHeight;var e=String(a.game.score).padStart(10,"0");if(a.gameOffsetTop===o.offsetTop){var t=a.gameOffsetLeft+10*a.game.tile+2*o.letterHeight;a.ctx.clearRect(t-o.letterHeight,o.offsetTop+4*o.letterHeight,10*o.letterWidth+2*o.letterHeight,4*o.letterHeight),a.ctx.fillText("Счёт:",t,o.offsetTop+5*o.letterHeight+o.fontSize),a.ctx.fillText(e,t,o.offsetTop+6*o.letterHeight+o.fontSize)}else{var n=window.innerWidth-a.gameOffsetLeft-e.length*o.letterWidth;a.ctx.clearRect(n-o.letterHeight,o.offsetTop-o.letterHeight,e.length*o.letterWidth+2*o.letterHeight,4*o.letterHeight),a.ctx.fillText(e,n,o.offsetTop+o.letterHeight/2+o.fontSize)}})),b(this,"BeforeDraw",(function(){a.ctx.shadowColor=o.options.color,a.ctx.shadowBlur=2*o.letterHeight/3,a.ctx.strokeStyle=o.options.color,a.ctx.clearRect(a.gameOffsetLeft-o.letterHeight,a.gameOffsetTop-o.letterHeight,a.game.window.width*a.game.tile+2*o.letterHeight,a.game.window.height*a.game.tile+2*o.letterHeight),a.ctx.strokeRect(a.gameOffsetLeft,a.gameOffsetTop,a.game.window.width*a.game.tile,a.game.window.height*a.game.tile)})),b(this,"DrawTile",(function(e,t,n){a.ctx.font="".concat(a.game.tile/1.15,"px monospace"),a.ctx.fillStyle=-1===n?o.options.color+"55":o.options.color,a.ctx.fillText("[]",a.gameOffsetLeft+t*a.game.tile,a.gameOffsetTop+e*a.game.tile+a.game.tile/1.35)})),this.terminal=t,this.canvas=n,this.ctx=i,this.game=new S.O(this.terminal,this.canvas,this.OnFigureChanged,this.OnScoreChanged,10,20),this.game.DrawTile=this.DrawTile,this.game.BeforeDraw=this.BeforeDraw,this.gameOffsetTop=0,this.gameOffsetLeft=0},k=n(529);function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e,t){for(var n=[],r=0;r<t;r++){n.push([]);for(var o=0;o<e;o++)n[r].push(0!==(0,i.Iy)(0,3)?{strength:(0,i.Iy)(1,3),style:0}:null)}return n}var R=function e(t,n,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),H(this,"Start",(function(){document.addEventListener("keydown",a.OnKeyDown),a.canvas.addEventListener("click",a.OnClick),a.game.LoadMap(L(10,8)),a.Resize(),a.game.Reset()})),H(this,"Leave",(function(){a.game.Stop(),document.removeEventListener("keydown",a.OnKeyDown),a.canvas.removeEventListener("click",a.OnClick)})),H(this,"OnClick",(function(){a.game.stop&&(a.game.LoadMap(L(10,8)),a.game.Reset())})),H(this,"OnKeyDown",(function(e){"KeyR"===e.code&&a.game.stop&&(a.game.LoadMap(L(10,8)),a.game.Reset())})),H(this,"OnScoreChanged",(function(){a.ctx.font="".concat(o.fontSize,"px monospace"),a.ctx.fillStyle=o.options.color,a.ctx.shadowColor=o.options.color,a.ctx.shadowBlur=o.letterHeight;var e=String(a.game.score).padStart(10,"0");if(a.gameOffsetTop===o.offsetTop){var t=a.gameOffsetLeft+a.game.window.width+2*o.letterHeight;a.ctx.clearRect(t-o.letterHeight,o.offsetTop+3*o.letterHeight,10*o.letterWidth+2*o.letterHeight,4*o.letterHeight),a.ctx.fillText("Счёт:",t,o.offsetTop+4*o.letterHeight+o.fontSize),a.ctx.fillText(e,t,o.offsetTop+5*o.letterHeight+o.fontSize)}else{var n=window.innerWidth-a.gameOffsetLeft-e.length*o.letterWidth;a.ctx.clearRect(n-o.letterHeight,o.offsetTop-o.letterHeight,e.length*o.letterWidth+2*o.letterHeight,4*o.letterHeight),a.ctx.fillText(e,n,o.offsetTop+o.letterHeight/2+o.fontSize)}})),H(this,"OnLifesChanged",(function(){var e,t;a.ctx.font="".concat(o.fontSize,"px monospace"),a.ctx.fillStyle=o.options.color,a.ctx.shadowColor=o.options.color,a.ctx.shadowBlur=o.letterHeight,a.gameOffsetTop===o.offsetTop?(e=a.gameOffsetLeft+a.game.window.width+2*o.letterHeight,t=o.offsetTop+o.letterHeight+o.fontSize,a.ctx.clearRect(e-o.letterHeight,o.offsetTop-o.letterHeight,10*o.letterWidth+2*o.letterHeight,4*o.letterHeight),a.ctx.fillText("Жизни:",e,o.offsetTop+o.fontSize)):(e=a.gameOffsetLeft,t=o.offsetTop+o.fontSize,a.ctx.clearRect(a.gameOffsetLeft-o.letterHeight,o.offsetTop-o.letterHeight,8*o.letterWidth+2*o.letterHeight,4*o.letterHeight)),a.ctx.fillText("".padEnd(a.game.lifes,"❤"),e,t)})),H(this,"Resize",(function(){var e=window.innerHeight-2*o.offsetTop,t=window.innerWidth-2*o.offsetLeft;e>=t?(e-=3*o.letterHeight,a.gameOffsetLeft=(window.innerWidth-t)/2,a.gameOffsetTop=o.offsetTop+3*o.letterHeight,a.game.Resize({width:t,height:e},a.gameOffsetLeft,a.gameOffsetTop)):((t-=10*o.letterWidth+2*o.letterHeight)>4*e/3&&(t=4*e/3),a.gameOffsetLeft=(window.innerWidth-t)/2-5*o.letterWidth,a.gameOffsetTop=o.offsetTop,a.game.Resize({width:t,height:e},a.gameOffsetLeft,a.gameOffsetTop)),r.h&&(a.ctx.font="".concat(o.fontSize,"px monospace"),a.ctx.fillStyle=o.options.color,a.ctx.fillText("X",window.innerWidth-o.letterWidth-16,o.fontSize+9)),a.OnScoreChanged(),a.OnLifesChanged()})),H(this,"BeforeDraw",(function(){a.ctx.shadowColor=o.options.color,a.ctx.shadowBlur=2*o.letterHeight/3,a.ctx.clearRect(a.gameOffsetLeft-o.letterHeight,a.gameOffsetTop-o.letterHeight,a.game.window.width+2*o.letterHeight,a.game.window.height+2*o.letterHeight),a.ctx.strokeStyle=o.options.color,a.ctx.strokeRect(a.gameOffsetLeft,a.gameOffsetTop,a.game.window.width,a.game.window.height)})),H(this,"DrawBrick",(function(e,t,n){a.ctx.strokeStyle=o.options.color;for(var i=0;i<n.strength;i++)a.ctx.strokeRect(a.gameOffsetLeft+t*a.game.brick.width+4*i,a.gameOffsetTop+e*a.game.brick.height+4*i,a.game.brick.width-8*i,a.game.brick.height-8*i)})),H(this,"DrawBall",(function(){a.game.bonus.active.some((function(e){return"Through"===e.name}))?a.ctx.strokeStyle=o.options.color+"55":a.ctx.strokeStyle=o.options.color,a.ctx.beginPath(),a.ctx.arc(a.gameOffsetLeft+a.game.ball.x,a.gameOffsetTop+a.game.ball.y,a.game.ball.rad,0,2*Math.PI),a.ctx.stroke()})),H(this,"DrawCarriage",(function(){a.ctx.strokeStyle=o.options.color,a.ctx.strokeRect(a.gameOffsetLeft+a.game.carriage.x,a.gameOffsetTop+a.game.carriage.y,a.game.carriage.width,a.game.carriage.height),a.ctx.strokeRect(a.gameOffsetLeft+a.game.carriage.x+4,a.gameOffsetTop+a.game.carriage.y+4,a.game.carriage.width-8,a.game.carriage.height-8)})),H(this,"DrawBonus",(function(e){var t=a.game.brick.width,n=!0;switch(e.y<=0?(t+=e.y,n=!1):a.game.window.height-e.y<a.game.brick.width&&(t=a.game.window.height-e.y,n=!1),e.name){case"Through":a.ctx.strokeStyle=o.options.color,a.ctx.strokeRect(a.gameOffsetLeft+e.x,e.y<0?a.gameOffsetTop:a.gameOffsetTop+e.y,a.game.brick.width,t),a.ctx.strokeStyle=o.options.color+"55",n&&(a.ctx.beginPath(),a.ctx.arc(a.gameOffsetLeft+e.x+a.game.brick.width/2,a.gameOffsetTop+e.y+a.game.brick.width/2,a.game.brick.width/4,0,2*Math.PI),a.ctx.stroke());break;case"BigBall":a.ctx.strokeStyle=o.options.color,a.ctx.strokeRect(a.gameOffsetLeft+e.x,e.y<0?a.gameOffsetTop:a.gameOffsetTop+e.y,a.game.brick.width,t),n&&(a.ctx.beginPath(),a.ctx.arc(a.gameOffsetLeft+e.x+a.game.brick.width/2,a.gameOffsetTop+e.y+a.game.brick.width/2,a.game.brick.width/2.1,0,2*Math.PI),a.ctx.stroke());break;case"SmallBall":a.ctx.strokeStyle=o.options.color,a.ctx.strokeRect(a.gameOffsetLeft+e.x,e.y<0?a.gameOffsetTop:a.gameOffsetTop+e.y,a.game.brick.width,t),n&&(a.ctx.beginPath(),a.ctx.arc(a.gameOffsetLeft+e.x+a.game.brick.width/2,a.gameOffsetTop+e.y+a.game.brick.width/2,a.game.brick.width/8,0,2*Math.PI),a.ctx.stroke());break;case"BigCarriage":a.ctx.strokeStyle=o.options.color,a.ctx.strokeRect(a.gameOffsetLeft+e.x,e.y<0?a.gameOffsetTop:a.gameOffsetTop+e.y,a.game.brick.width,t),n&&a.ctx.strokeRect(a.gameOffsetLeft+e.x+a.game.brick.width/8,a.gameOffsetTop+e.y+2*a.game.brick.width/5,6*a.game.brick.width/8,a.game.brick.width/5);break;case"SmallCarriage":a.ctx.strokeStyle=o.options.color,a.ctx.strokeRect(a.gameOffsetLeft+e.x,e.y<0?a.gameOffsetTop:a.gameOffsetTop+e.y,a.game.brick.width,t),n&&a.ctx.strokeRect(a.gameOffsetLeft+e.x+a.game.brick.width/3,a.gameOffsetTop+e.y+2*a.game.brick.width/5,a.game.brick.width/3,a.game.brick.width/5);break;case"Death":a.ctx.strokeStyle=o.options.color,a.ctx.strokeRect(a.gameOffsetLeft+e.x,e.y<0?a.gameOffsetTop:a.gameOffsetTop+e.y,a.game.brick.width,t),n&&(a.ctx.font="".concat(a.game.brick.width/1.15,"px monospace"),a.ctx.fillStyle=o.options.color,a.ctx.fillText("☠",a.gameOffsetLeft+e.x+a.game.brick.width/12,a.gameOffsetTop+e.y+a.game.brick.width/1.35+2));break;default:a.ctx.strokeStyle=o.options.color,a.ctx.strokeRect(a.gameOffsetLeft+e.x,e.y<0?a.gameOffsetTop:a.gameOffsetTop+e.y,a.game.brick.width,t)}})),this.terminal=t,this.canvas=n,this.ctx=i,this.game=new k.S(this.terminal,this.canvas,this.OnScoreChanged,this.OnLifesChanged),this.game.BeforeDraw=this.BeforeDraw,this.game.DrawBrick=this.DrawBrick,this.game.DrawBall=this.DrawBall,this.game.DrawCarriage=this.DrawCarriage,this.game.DrawBonus=this.DrawBonus,this.gameOffsetTop=0,this.gameOffsetLeft=0},P=n(3585);function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var M=function e(t,n,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),W(this,"Start",(function(){document.addEventListener("keydown",a.OnKeyDown),a.canvas.addEventListener("click",a.OnClick),r.h||(a.selectedMatrixCell=0),a.Resize()})),W(this,"Leave",(function(){document.removeEventListener("keydown",a.OnKeyDown),a.canvas.removeEventListener("click",a.OnClick)})),W(this,"OnClick",(function(e){if(!a.gameBlocked){var t=a.gameSide/3,n=a.gameOffsetTop===o.offsetTop?a.gameOffsetLeft+a.gameSide+2*o.letterHeight:a.gameOffsetLeft;if(e.clientX>a.gameOffsetLeft&&e.clientX<a.gameOffsetLeft+a.gameSide&&e.clientY>o.offsetTop&&e.clientY<o.offsetTop+a.gameSide){if(null!==a.game.winner)return a.game.Reset(),void a.OnMatrixChanged();var i=Math.floor((e.clientY-o.offsetTop)/t),r=Math.floor((e.clientX-a.gameOffsetLeft)/t);a.game.HandleClick(3*i+r),setTimeout((function(){a.gameBlocked=!1}),500),a.gameBlocked=!0,a.OnMatrixChanged()}else if(e.clientX>n&&e.clientX<n+24*o.letterWidth&&e.clientY>a.gameOffsetTop&&e.clientY<a.gameOffsetTop+5*o.letterHeight){var l=Math.floor((e.clientY-a.gameOffsetTop)/(5*o.letterHeight/3));if(0===l){var c=Math.floor((e.clientX-n-14*o.letterWidth)/(4*o.letterWidth));0===c?(a.game.firstPlayer="X",a.game.secondPlayer="O"):1===c&&(a.game.firstPlayer="O",a.game.secondPlayer="X")}else if(1===l){var f=Math.floor((e.clientX-n-8*o.letterWidth)/(8*o.letterWidth));0===f?a.game.withAI=!0:1===f&&(a.game.withAI=!1)}else if(2===l){var s=Math.floor((e.clientX-n-11*o.letterWidth)/(5*o.letterWidth));0===s?a.game.difficultyLevel=0:1===s?a.game.difficultyLevel=1:2===s&&(a.game.difficultyLevel=2)}a.game.Reset(),a.OnSettingsChanged()}}})),W(this,"OnKeyDown",(function(e){if("KeyR"===e.code)return a.selectedMatrixCell=0,a.selectedSettingsRow=null,a.game.Reset(),void a.OnSettingsChanged();if(null!==a.game.winner&&"KeyS"===e.code)return a.selectedSettingsRow=0,a.game.Reset(),void a.OnSettingsChanged();if(null!==a.selectedSettingsRow)switch(e.code){case"ArrowLeft":switch(a.selectedSettingsRow){case 0:a.game.firstPlayer="X"===a.game.firstPlayer?"O":"X",a.game.secondPlayer="X"===a.game.secondPlayer?"O":"X";break;case 1:a.game.withAI=!a.game.withAI;break;case 2:a.game.difficultyLevel=(a.game.difficultyLevel+2)%3}a.game.Reset(),a.OnSettingsChanged();break;case"ArrowRight":switch(a.selectedSettingsRow){case 0:a.game.firstPlayer="X"===a.game.firstPlayer?"O":"X",a.game.secondPlayer="X"===a.game.secondPlayer?"O":"X";break;case 1:a.game.withAI=!a.game.withAI;break;case 2:a.game.difficultyLevel=(a.game.difficultyLevel+1)%3}a.game.Reset(),a.OnSettingsChanged();break;case"ArrowUp":a.selectedSettingsRow=(a.selectedSettingsRow+2)%3,a.OnSettingsChanged();break;case"ArrowDown":a.selectedSettingsRow=(a.selectedSettingsRow+1)%3,a.OnSettingsChanged();break;case"KeyS":a.selectedSettingsRow=null,a.selectedMatrixCell=0,a.OnMatrixChanged(),a.OnSettingsChanged()}else if(null!==a.selectedMatrixCell)switch(e.code){case"ArrowLeft":a.selectedMatrixCell=3*Math.floor(a.selectedMatrixCell/3)+(a.selectedMatrixCell+2)%3,a.OnMatrixChanged();break;case"ArrowRight":a.selectedMatrixCell=3*Math.floor(a.selectedMatrixCell/3)+(a.selectedMatrixCell+1)%3,a.OnMatrixChanged();break;case"ArrowUp":a.selectedMatrixCell=(a.selectedMatrixCell+6)%9,a.OnMatrixChanged();break;case"ArrowDown":a.selectedMatrixCell=(a.selectedMatrixCell+3)%9,a.OnMatrixChanged();break;case"KeyS":a.selectedMatrixCell=null,a.selectedSettingsRow=0,a.OnSettingsChanged(),a.OnMatrixChanged();break;case"Space":a.game.HandleClick(a.selectedMatrixCell),setTimeout((function(e){a.selectedMatrixCell=null===a.game.winner?e:null}),500,a.selectedMatrixCell),a.selectedMatrixCell=null,a.OnMatrixChanged()}})),W(this,"OnMatrixChanged",(function(){a.ctx.shadowColor=o.options.color,a.ctx.shadowBlur=o.letterHeight/2,a.ctx.fillStyle=o.options.color,a.ctx.strokeStyle=o.options.color;var e=a.gameSide/39,t=function(t,n){var i=n*(a.gameSide/3)+a.gameOffsetLeft,r=t*(a.gameSide/3)+o.offsetTop;a.ctx.beginPath(),a.ctx.moveTo(i+7*e,r+9*e),a.ctx.lineTo(i+7*e,r+10*e),a.ctx.lineTo(i+7.5*e,r+10*e),a.ctx.moveTo(i+8.5*e,r+8*e),a.ctx.lineTo(i+9*e,r+8*e),a.ctx.lineTo(i+9*e,r+9*e),a.ctx.moveTo(i+8*e,r+11*e),a.ctx.lineTo(i+8*e,r+12*e),a.ctx.lineTo(i+10*e,r+12*e),a.ctx.lineTo(i+10*e,r+10*e),a.ctx.lineTo(i+9.5*e,r+10*e),a.ctx.moveTo(i+3*e,r+3*e),a.ctx.lineTo(i+3*e,r+4*e),a.ctx.lineTo(i+3.5*e,r+4*e),a.ctx.moveTo(i+4.5*e,r+2*e),a.ctx.lineTo(i+5*e,r+2*e),a.ctx.lineTo(i+5*e,r+3*e),a.ctx.moveTo(i+4*e,r+5*e),a.ctx.lineTo(i+4*e,r+6*e),a.ctx.lineTo(i+4.5*e,r+6*e),a.ctx.moveTo(i+5.5*e,r+4*e),a.ctx.lineTo(i+6*e,r+4*e),a.ctx.lineTo(i+6*e,r+5*e),a.ctx.moveTo(i+3*e,r+11*e),a.ctx.lineTo(i+3*e,r+12*e),a.ctx.lineTo(i+5*e,r+12*e),a.ctx.lineTo(i+5*e,r+10*e),a.ctx.lineTo(i+6*e,r+10*e),a.ctx.lineTo(i+6*e,r+8*e),a.ctx.lineTo(i+6.5*e,r+8*e),a.ctx.moveTo(i+8*e,r+7*e),a.ctx.lineTo(i+8*e,r+6*e),a.ctx.lineTo(i+9*e,r+6*e),a.ctx.lineTo(i+9*e,r+4*e),a.ctx.lineTo(i+10*e,r+4*e),a.ctx.lineTo(i+10*e,r+2*e),a.ctx.lineTo(i+9.5*e,r+2*e),a.ctx.stroke(),a.ctx.fillRect(i+2.5*e,r+1*e,2*e,2*e),a.ctx.fillRect(i+7.5*e,r+1*e,2*e,2*e),a.ctx.fillRect(i+3.5*e,r+3*e,2*e,2*e),a.ctx.fillRect(i+6.5*e,r+3*e,2*e,2*e),a.ctx.fillRect(i+4.5*e,r+5*e,3*e,2*e),a.ctx.fillRect(i+3.5*e,r+7*e,2*e,2*e),a.ctx.fillRect(i+6.5*e,r+7*e,2*e,2*e),a.ctx.fillRect(i+2.5*e,r+9*e,2*e,2*e),a.ctx.fillRect(i+7.5*e,r+9*e,2*e,2*e)},n=function(t,n){var i=n*(a.gameSide/3)+a.gameOffsetLeft,r=t*(a.gameSide/3)+o.offsetTop;a.ctx.beginPath(),a.ctx.moveTo(i+3*e,r+9*e),a.ctx.lineTo(i+3*e,r+10*e),a.ctx.lineTo(i+3.5*e,r+10*e),a.ctx.moveTo(i+5*e,r+9*e),a.ctx.lineTo(i+5*e,r+4*e),a.ctx.lineTo(i+7.5*e,r+4*e),a.ctx.moveTo(i+8.5*e,r+2*e),a.ctx.lineTo(i+9*e,r+2*e),a.ctx.lineTo(i+9*e,r+3*e),a.ctx.moveTo(i+9.5*e,r+4*e),a.ctx.lineTo(i+10*e,r+4*e),a.ctx.lineTo(i+10*e,r+10*e),a.ctx.lineTo(i+9*e,r+10*e),a.ctx.lineTo(i+9*e,r+12*e),a.ctx.lineTo(i+4*e,r+12*e),a.ctx.lineTo(i+4*e,r+11*e),a.ctx.stroke(),a.ctx.fillRect(i+3.5*e,r+1*e,5*e,2*e),a.ctx.fillRect(i+2.5*e,r+3*e,2*e,6*e),a.ctx.fillRect(i+3.5*e,r+9*e,5*e,2*e),a.ctx.fillRect(i+7.5*e,r+3*e,2*e,6*e)};a.ctx.clearRect(a.gameOffsetLeft-o.letterHeight,o.offsetTop-o.letterHeight,a.gameSide+2*o.letterHeight,a.gameSide+2*o.letterHeight);for(var i=a.gameSide/3,l=0;l<9;l++){var c=Math.floor(l/3),f=l%3;a.ctx.strokeRect(a.gameOffsetLeft+i*f+2,o.offsetTop+i*c+2,i-4,i-4),"X"===a.game.matrix[l]?t(c,f):"O"===a.game.matrix[l]&&n(c,f)}r.h||null===a.selectedMatrixCell||(a.ctx.fillStyle=o.options.color+"33",a.ctx.strokeStyle=o.options.color+"33",a.game.IsNext("X")?t(Math.floor(a.selectedMatrixCell/3),a.selectedMatrixCell%3):n(Math.floor(a.selectedMatrixCell/3),a.selectedMatrixCell%3),a.ctx.fillStyle=o.options.color,a.ctx.strokeStyle=o.options.color)})),W(this,"OnSettingsChanged",(function(){a.ctx.font="".concat(o.fontSize,"px monospace"),a.ctx.shadowColor=o.options.color,a.ctx.shadowBlur=o.letterHeight/2,a.ctx.fillStyle=o.options.color;var e=a.gameOffsetTop===o.offsetTop?a.gameOffsetLeft+a.gameSide+2*o.letterHeight:a.gameOffsetLeft;a.ctx.clearRect(e-o.letterHeight,a.gameOffsetTop-o.letterHeight,24*o.letterWidth+2*o.letterHeight,7*o.letterHeight+4),a.ctx.fillText("".concat(0===a.selectedSettingsRow?">":" ","Первый ходит:  X   O"),e,a.gameOffsetTop+o.fontSize),"X"===a.game.firstPlayer?(a.ctx.fillRect(e+15*o.letterWidth-4,a.gameOffsetTop,3*o.letterWidth+8,o.letterHeight+4),a.ctx.fillStyle="#000",a.ctx.fillText("X",e+16*o.letterWidth,a.gameOffsetTop+o.fontSize)):(a.ctx.fillRect(e+19*o.letterWidth-4,a.gameOffsetTop,3*o.letterWidth+8,o.letterHeight+4),a.ctx.fillStyle="#000",a.ctx.fillText("O",e+20*o.letterWidth,a.gameOffsetTop+o.fontSize)),a.ctx.fillStyle=o.options.color,a.ctx.fillText("".concat(1===a.selectedSettingsRow?">":" ","Играть: Одному Вдвоём"),e,a.gameOffsetTop+o.fontSize+2*o.letterHeight),a.game.withAI?(a.ctx.fillRect(e+9*o.letterWidth-4,a.gameOffsetTop+2*o.letterHeight,6*o.letterWidth+8,o.letterHeight+4),a.ctx.fillStyle="#000",a.ctx.fillText("Одному",e+9*o.letterWidth,a.gameOffsetTop+o.fontSize+2*o.letterHeight)):(a.ctx.fillRect(e+16*o.letterWidth-4,a.gameOffsetTop+2*o.letterHeight,6*o.letterWidth+8,o.letterHeight+4),a.ctx.fillStyle="#000",a.ctx.fillText("Вдвоём",e+16*o.letterWidth,a.gameOffsetTop+o.fontSize+2*o.letterHeight)),a.ctx.fillStyle=o.options.color,a.ctx.fillText("".concat(2===a.selectedSettingsRow?">":" ","Сложность:  X   XX  XXX"),e,a.gameOffsetTop+o.fontSize+4*o.letterHeight),0===a.game.difficultyLevel?(a.ctx.fillRect(e+12*o.letterWidth,a.gameOffsetTop+4*o.letterHeight,3*o.letterWidth,o.letterHeight+4),a.ctx.fillStyle="#000",a.ctx.fillText("X",e+13*o.letterWidth,a.gameOffsetTop+o.fontSize+4*o.letterHeight)):1===a.game.difficultyLevel?(a.ctx.fillRect(e+16*o.letterWidth,a.gameOffsetTop+4*o.letterHeight,4*o.letterWidth,o.letterHeight+4),a.ctx.fillStyle="#000",a.ctx.fillText("XX",e+17*o.letterWidth,a.gameOffsetTop+o.fontSize+4*o.letterHeight)):(a.ctx.fillRect(e+21*o.letterWidth-4,a.gameOffsetTop+4*o.letterHeight,3*o.letterWidth+8,o.letterHeight+4),a.ctx.fillStyle="#000",a.ctx.fillText("XXX",e+21*o.letterWidth,a.gameOffsetTop+o.fontSize+4*o.letterHeight)),a.ctx.fillStyle=o.options.color})),W(this,"OnCrossChanged",(function(){if(null!==a.game.cross){a.selectedSettingsRow=null,a.selectedMatrixCell=null;for(var e=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],t=0;t<a.game.matrix.length;t++)e[a.game.cross].includes(t)||(a.game.matrix[t]=null);a.OnMatrixChanged()}})),W(this,"Resize",(function(){var e=window.innerHeight-2*o.offsetTop,t=window.innerWidth-2*o.offsetLeft;t<4*e/3?((e-=8*o.letterHeight)<t?t=e:e=t,a.gameOffsetLeft=(window.innerWidth-t)/2,a.gameOffsetTop=o.offsetTop+e+2*o.letterHeight):((t-=24*o.letterWidth+2*o.letterHeight)>e?t=e:e=t,a.gameOffsetLeft=(window.innerWidth-t)/2-12*o.letterWidth,a.gameOffsetTop=o.offsetTop),a.gameSide=t,r.h&&(a.ctx.font="".concat(o.fontSize,"px monospace"),a.ctx.fillStyle=o.options.color,a.ctx.fillText("X",window.innerWidth-o.letterWidth-16,o.fontSize+9)),a.OnMatrixChanged(),a.OnCrossChanged(),a.OnSettingsChanged()})),this.terminal=t,this.canvas=n,this.ctx=i,this.game=new P.b(this.OnMatrixChanged,this.OnCrossChanged),this.gameOffsetTop=0,this.gameOffsetLeft=0,this.selectedMatrixCell=null,this.selectedSettingsRow=null,this.gameSide,this.gameBlocked=!1};function I(e){return function(e){if(Array.isArray(e))return z(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||D(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,r,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw r}}return o}(e,t)||D(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){if(e){if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function A(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),B(this,"FocusInput",(function(){a.input.focus(),a.input.addEventListener("focusout",a.input.focus),a.input.addEventListener("input",a.OnInput),a.input.addEventListener("keydown",a.OnKeyDown)})),B(this,"UnfocusInput",(function(){a.input.removeEventListener("focusout",a.input.focus),a.input.removeEventListener("input",a.OnInput),a.input.removeEventListener("keydown",a.OnKeyDown),a.btn.focus()})),B(this,"ChangeTheme",(function(e){a.terminal.remove(),a.UnfocusInput(),window.removeEventListener("resize",a.OnResize),a.changeTheme(e)})),B(this,"OnOptionChanged",(function(){var e=E([0,0,0].map((function(e,t){return parseInt(o.options.color.substr(2*t+1,2),16)})),3),t=e[0],n=e[1],i=e[2];a.terminal.style.background="#000 radial-gradient(circle, rgba(".concat(t,",").concat(n,",").concat(i,",0.15) 0%, rgb(0,0,0) 100%)"),a.canvas.style.background="linear-gradient(180deg,rgba(0, 0, 0, 0) 0%,rgba(0, 0, 0, 0)\n         80%,rgba(".concat(t,",").concat(n,",").concat(i,", 0.05) 99%,rgba(0, 0, 0, 0) 100%)no-repeat"),clearTimeout(a.glitch),a.glitch=o.options.isGlitched?setTimeout(a.Glitch,200):void 0,a.SetDirTheme(),localStorage.setItem("terminalOptions",JSON.stringify(o.options))})),B(this,"StartGame",(function(e){a.gameStarted=e,a.UnfocusInput(),document.addEventListener("keydown",a.GameOnKeyDown),r.h&&a.btn.addEventListener("click",a.LeaveGame),clearTimeout(a.glitch),a.ctx.clearRect(0,0,a.canvas.width,a.canvas.height),a[a.gameStarted].Start()})),B(this,"LeaveGame",(function(){a[a.gameStarted].Leave(),a.gameStarted=void 0,a.FocusInput(),a.glitch=o.options.isGlitched?setTimeout(a.Glitch,200):void 0,document.removeEventListener("keydown",a.GameOnKeyDown),r.h&&a.btn.removeEventListener("click",a.LeaveGame),a.Redraw()})),B(this,"GameOnKeyDown",(function(e){"Escape"===e.code&&a.LeaveGame()})),B(this,"ClearHistory",(function(){a.history=[]})),B(this,"ExecuteCommand",(function(){var e=a.input.value.trim(),t=e.indexOf(" "),n=-1===t?e.toLowerCase():e.substr(0,t).toLowerCase(),i=-1===t?"":e.substr(t+1);if(n in a.interpreter&&"function"==typeof a.interpreter[n]){var r=a.interpreter[n](i);if(!r||0===r.length)return;if(r.reduce((function(e,t){return e+Math.ceil(t.length/o.columnCount)}),0)>=o.rowCount-1){var l,c=a.history.reduce((function(e,t){return e+Math.ceil(t.length/o.columnCount)}),0),f=0,s=!1,h=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=D(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}(r);try{for(h.s();!(l=h.n()).done;){var u=l.value,g=Math.ceil(u.length/o.columnCount);f+g<=o.rowCount-c-2&&!s?(f+=g,s=!0,a.history.push(u)):a.buffer.push(u)}}catch(e){h.e(e)}finally{h.f()}a.buffer.reverse(),a.initialBufferLenght=a.buffer.length}else{var d;(d=a.history).push.apply(d,I(r))}}else a.history.push('Команда "'.concat(n,'" не найдена'))})),B(this,"OnInput",(function(e){0===a.initialBufferLenght||"q"!==e.data&&"Q"!==e.data||(a.buffer=[],a.initialBufferLenght=0,a.input.value=""),a.Redraw()})),B(this,"OnKeyDown",(function(e){if(0===a.initialBufferLenght)switch(e.key){case"Enter":(a.prefix+a.input.value).split("\n").forEach((function(e){return a.history.push(e.trim())})),a.commandsHistory.unshift(a.input.value),a.ExecuteCommand(),a.input.value="",a.commandIndex=-1,a.Redraw(),e.preventDefault();break;case"ArrowUp":a.commandIndex<a.commandsHistory.length-1&&(a.commandIndex++,a.commandIndex>-1&&(a.input.value=a.commandsHistory[a.commandIndex],a.Redraw())),e.preventDefault();break;case"ArrowDown":a.commandIndex>-1&&(a.commandIndex--,a.commandIndex>-1&&(a.input.value=a.commandsHistory[a.commandIndex],a.Redraw())),e.preventDefault();break;case"ArrowLeft":0!==a.input.selectionStart&&a.Redraw(a.input.selectionStart-1);break;case"ArrowRight":a.input.selectionStart!==a.input.value.length&&a.Redraw(a.input.selectionStart+1);break;case"Tab":e.preventDefault()}else{switch(e.key){case"ArrowUp":a.buffer.length<a.initialBufferLenght&&a.buffer.push(a.history.pop());break;case"ArrowDown":case"Enter":a.buffer.length>0&&a.history.push(a.buffer.pop())}a.Redraw()}})),B(this,"OnResize",(function(){var e=8/448;o.fontSize=Math.floor(window.innerWidth*e+10.285714285714286),o.fontSize=o.fontSize>24?24:o.fontSize,a.ctx.font="".concat(o.fontSize,"px monospace"),o.letterWidth=a.ctx.measureText("M").width,o.letterHeight=1.15*o.fontSize,o.columnCount=Math.floor(window.innerWidth/12*10/o.letterWidth),o.rowCount=Math.floor(window.innerHeight/12*10/o.letterHeight),o.offsetLeft=(window.innerWidth-o.columnCount*o.letterWidth)/2,o.offsetTop=(window.innerHeight-o.rowCount*o.letterHeight)/2,a.canvas.width=window.innerWidth,a.canvas.height=window.innerHeight,a.SetDirTheme(),a.gameStarted?a[a.gameStarted].Resize():a.Redraw()})),B(this,"Redraw",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.input.selectionStart;if(!a.gameStarted){var t=a.prefix+a.input.value;e+=a.prefix.length,a.ctx.font="".concat(o.fontSize,"px monospace"),a.ctx.shadowColor=o.options.color,a.ctx.shadowBlur=o.letterHeight,a.ctx.clearRect(0,0,a.canvas.width,a.canvas.height),a.ctx.fillStyle=o.options.color;for(var n=[],i=0;i<a.history.length;i++)for(var r=0;r<Math.ceil(a.history[i].length/o.columnCount);r++)n.push(a.history[i].substr(r*o.columnCount,o.columnCount));var l,c=Math.ceil(t.length/o.columnCount);l=n.length+c>o.rowCount?o.rowCount-c:n.length;for(var f=n.length-l;f<n.length;f++)a.ctx.fillText(n[f],o.offsetLeft,o.offsetTop+(f-n.length+l)*o.letterHeight+o.fontSize);if(0!==a.initialBufferLenght)0===a.buffer.length?(a.ctx.fillRect(o.offsetLeft,o.offsetTop+l*o.letterHeight,5*o.letterWidth,o.letterHeight),a.ctx.fillStyle="#000",a.ctx.fillText("(END)",o.offsetLeft,o.offsetTop+l*o.letterHeight+o.fontSize)):(a.ctx.fillText(":",o.offsetLeft,o.offsetTop+l*o.letterHeight+o.fontSize),a.ctx.fillRect(o.offsetLeft+o.letterWidth,o.offsetTop+l*o.letterHeight,1*o.letterWidth,o.letterHeight));else{for(var s=c>o.rowCount?c-o.rowCount:0;s<c;s++){var h=t.substr(s*o.columnCount,o.columnCount);a.ctx.fillText(h,o.offsetLeft,o.offsetTop+(l+s)*o.letterHeight+o.fontSize)}var u=e%o.columnCount==0?e/o.columnCount+1:Math.ceil(e/o.columnCount),g=e-o.columnCount*(u-1);a.ctx.fillRect(o.offsetLeft+g*o.letterWidth,o.offsetTop+(l+u-1)*o.letterHeight+2,o.letterWidth,o.letterHeight-2),e!==t.length&&(a.ctx.fillStyle="#000",a.ctx.fillText(t[e],o.offsetLeft+g*o.letterWidth,o.offsetTop+(l+u-1)*o.letterHeight+o.fontSize))}}})),B(this,"Glitch",(function(){for(var e=a.ctx.getImageData(0,0,a.canvas.width,a.canvas.height),t=(0,i.Iy)(1,5),n=(0,i.Iy)(5,8),r=0;r<e.height;r++)for(var l=r*e.width,c=Math.ceil(r%(o.letterHeight*t)/n),f=0;f<e.width;f++)e.data[4*(l+f)]=e.data[4*(l+(f+c))],e.data[4*(l+f)+1]=e.data[4*(l+(f+c))+1],e.data[4*(l+f)+2]=e.data[4*(l+(f+c))+2],e.data[4*(l+f)+3]=e.data[4*(l+(f+c))+3];a.ctx.putImageData(e,0,0),a.gameStarted||setTimeout(a.Redraw,100),a.glitch=setTimeout(a.Glitch,(0,i.Iy)(300,5e3))})),this.rootElement=t,this.changeTheme=n,this.terminal=(0,i.wC)("terminal"),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.input=document.createElement("input",{type:"text"}),this.btn=document.createElement("button"),this.rootElement.append(this.terminal),this.terminal.append(this.canvas),this.terminal.append(this.input),this.terminal.append(this.btn),this.buffer=[],this.initialBufferLenght=0,this.history=[],this.commandsHistory=[],this.commandIndex=-1,this.prefix,this.glitch,this.gameStarted,this.tetris=new C(this.terminal,this.canvas,this.ctx),this.arkanoid=new R(this.terminal,this.canvas,this.ctx),this.ticTacToe=new M(this.terminal,this.canvas,this.ctx),this.interpreter=new T(this.ClearHistory,this.OnOptionChanged,this.ChangeTheme,this.StartGame),this.FocusInput(),window.addEventListener("resize",this.OnResize),this.OnOptionChanged(),this.OnResize()}var t,n,a;return t=e,(n=[{key:"SetDirTheme",value:function(){switch(o.options.ps){case 0:this.prefix="┌──(user㉿".concat(navigator.platform,")").concat(o.options.showPos?"-[".concat(o.curPos,"]"):"","\n"),this.prefix=this.prefix.padEnd(Math.ceil(this.prefix.length/o.columnCount)*o.columnCount)+"└─$ ";break;case 1:this.prefix="user@".concat(navigator.platform).concat(o.options.showPos?":".concat(o.curPos):"","$ ");break;case 2:this.prefix="".concat(o.options.showPos?o.curPos:"",">")}}}])&&A(t.prototype,n),a&&A(t,a),e}()}}]);